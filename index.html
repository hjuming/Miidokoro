<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ­å¹Œã€‚å¾¡å±…æ‰€ï½œä¸­ç§‹ç¯€å¿«æ¨‚</title>

    <!-- ç¶²é åˆ†äº«è³‡è¨Š -->
    <meta name="description" content="ä¾†è‡ªæœ­å¹Œãƒ»å¾¡å±…æ‰€çš„ä¸­ç§‹ç¥ç¦ã€‚ç«‹å³æŸ¥çœ‹æˆ‘å€‘çš„å°ˆå±¬å„ªæƒ ï¼Œä¸¦è®“ åŒ—æµ·é“æ—…ç¨‹è¦åŠƒåŠ©ç† ç‚ºæ‚¨æ‰“é€ ç¨ä¸€ç„¡äºŒçš„åŒ—æµ·é“ä¹‹æ—…ï¼">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://www.miidokoro.com/">
    <meta property="og:title" content="æœ­å¹Œã€‚å¾¡å±…æ‰€ï½œä¸­ç§‹ç¯€å¿«æ¨‚">
    <meta property="og:description" content="ä¾†è‡ªæœ­å¹Œãƒ»å¾¡å±…æ‰€çš„ä¸­ç§‹ç¥ç¦ã€‚ç«‹å³æŸ¥çœ‹æˆ‘å€‘çš„å°ˆå±¬å„ªæƒ ï¼Œä¸¦è®“ AI æ—…ç¨‹è¦åŠƒåŠ©ç†ç‚ºæ‚¨æ‰“é€ ç¨ä¸€ç„¡äºŒçš„åŒ—æµ·é“ä¹‹æ—…ï¼">
    <meta property="og:image" content="https://i.urusai.cc/v1xGt.jpeg">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="http://www.miidokoro.com/">
    <meta property="twitter:title" content="æœ­å¹Œã€‚å¾¡å±…æ‰€ï½œä¸­ç§‹ç¯€å¿«æ¨‚">
    <meta property="twitter:description" content="ä¾†è‡ªæœ­å¹Œãƒ»å¾¡å±…æ‰€çš„ä¸­ç§‹ç¥ç¦ã€‚ç«‹å³æŸ¥çœ‹æˆ‘å€‘çš„å°ˆå±¬å„ªæƒ ï¼Œä¸¦è®“ AI æ—…ç¨‹è¦åŠƒåŠ©ç†ç‚ºæ‚¨æ‰“é€ ç¨ä¸€ç„¡äºŒçš„åŒ—æµ·é“ä¹‹æ—…ï¼">
    <meta property="twitter:image" content="https://i.urusai.cc/v1xGt.jpeg">

    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* ä½¿ç”¨ Noto Serif TC ä½œç‚ºä¸»è¦å­—é«” */
        body {
            font-family: 'Noto Serif TC', serif;
            background-image: url('https://i.urusai.cc/v1xGt.jpeg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed; /* å›ºå®šèƒŒæ™¯ï¼Œæ»¾å‹•æ™‚ä¸ç§»å‹• */
        }
        /* å¡ç‰‡ç»ç’ƒæ“¬æ…‹æ•ˆæœ */
        .glass-card {
            background: rgba(23, 23, 23, 0.6); /* åŠé€æ˜æ·±è‰²èƒŒæ™¯ */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- ä¸»å¡ç‰‡å®¹å™¨ -->
    <div class="glass-card w-full max-w-md mx-auto rounded-2xl shadow-2xl text-white p-8 md:p-10 text-center overflow-hidden">
        
        <!-- æ—…åº— Logo -->
        <img src="https://i.urusai.cc/jR46f.jpeg" alt="æœ­å¹Œã€‚å¾¡å±…æ‰€ Logo" class="w-24 h-24 mx-auto mb-6 rounded-full border-2 border-white/50 shadow-lg">

        <!-- è³€è© -->
        <h1 class="text-3xl md:text-4xl font-bold tracking-wider mb-2">æœˆåœ“äººåœ˜åœ“</h1>
        <p class="text-lg md:text-xl font-semibold mb-6">ä¸­ç§‹ä½³ç¯€æ„‰å¿«</p>
        <p class="text-sm text-gray-300 mb-4">æœ­å¹Œãƒ»å¾¡å±…æ‰€ æ•¬è³€</p>
        
        <!-- åˆ†éš”ç·š -->
        <hr class="border-white/20 my-8">

        <!-- å„ªæƒ è³‡è¨Šå€å¡Š -->
        <a href="http://www.miidokoro.com" target="_blank" class="block rounded-xl overflow-hidden group">
            <div class="relative w-full aspect-video bg-cover bg-center shadow-lg group-hover:scale-105 transition-transform duration-300" style="background-image: url('https://i.urusai.cc/R7YL.jpeg');">
                <div class="absolute inset-0 bg-black/50 flex flex-col items-center justify-center p-4">
                    <h2 class="text-xl font-bold tracking-widest text-amber-300 mb-3">ç·šä¸Šè¨‚æˆ¿å°ˆå±¬å„ªæƒ </h2>
                    <div class="mt-2 border-2 border-dashed border-amber-400/50 rounded-lg p-3 inline-block">
                        <p class="text-2xl font-bold tracking-widest text-amber-300">MIIDOKORO</p>
                    </div>
                    <p class="text-gray-200 text-sm pt-4">åŠ å…¥æœƒå“¡å³äº«æŠ˜æ‰£ãƒ»é€éå®˜ç¶²è¼•é¬†æŸ¥è©¢èˆ‡é ç´„</p>
                </div>
            </div>
        </a>

        <!-- è¡Œå‹•å‘¼ç±²æŒ‰éˆ• -->
        <a href="http://www.miidokoro.com" target="_blank" 
           class="inline-block bg-amber-400 text-slate-800 font-bold py-3 px-8 rounded-lg mt-8 hover:bg-amber-300 transition-all duration-300 shadow-lg hover:shadow-amber-400/30">
            ç«‹å³é è¨‚ä½ çš„åŒ—æµ·é“ä¹‹æ—…
        </a>

        <!-- åˆ†éš”ç·š -->
        <hr class="border-white/20 my-8">

        <!-- Gemini API åŠŸèƒ½å€å¡Š -->
        <div class="space-y-4">
            <h2 class="text-lg font-bold tracking-widest text-amber-300 mb-3">âœ¨ åŒ—æµ·é“æ—…ç¨‹è¦åŠƒ</h2>
            <p class="text-sm text-gray-300 mb-4">å°åŒ—æµ·é“æ—…éŠæœ‰ä»€éº¼æƒ³æ³•å—ï¼Ÿ<br>è®“ å¾¡å±…æ‰€AIå®¢æœ ç‚ºæ‚¨æä¾›éˆæ„Ÿï¼</p>
            <textarea id="prompt-input" class="w-full h-24 p-3 bg-gray-900/50 rounded-lg border border-white/20 focus:ring-amber-400 focus:border-amber-400 transition-all text-white placeholder-gray-400" placeholder="ä¾‹å¦‚ï¼šè«‹æ¨è–¦äº”å€‹é©åˆç§‹å­£çš„æœ­å¹Œå‘¨é‚Šæ™¯é»"></textarea>
            <button id="generate-btn" class="w-full bg-slate-700 text-amber-300 font-bold py-3 px-8 rounded-lg hover:bg-slate-600 transition-all duration-300 flex items-center justify-center gap-2">
                <svg id="loader" class="animate-spin h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <span>ç²å–æ—…éŠéˆæ„Ÿ</span>
            </button>
            <div id="result-container" class="mt-4 p-4 bg-black/30 rounded-lg text-left text-gray-200 hidden min-h-[100px] whitespace-pre-wrap"></div>
        </div>
        
        <!-- é å°¾ -->
        <div class="mt-10 pt-6 border-t border-white/20 text-xs text-gray-400 space-y-3">
            <div class="space-y-1">
                <p>Miidokoro House Hotel</p>
                <p>â˜ï¸ +81 11-521-5000</p>
                <p>ğŸ  æ—¥æœ¬åŒ—æµ·é“ã€’064-0914 æœ­å¹Œå¸‚ä¸­å¤®åŒºå—14æ¡è¥¿14ä¸ç›®1ç•ª35å·</p>
                <a href="http://www.miidokoro.com" target="_blank" class="hover:text-amber-300 transition-colors duration-300">www.miidokoro.com</a>
            </div>
            <p class="pt-2">&copy; 2025 Sapporo Miidokoro. All Rights Reserved.</p>
        </div>

    </div>

    <script>
        const generateBtn = document.getElementById('generate-btn');
        const promptInput = document.getElementById('prompt-input');
        const resultContainer = document.getElementById('result-container');
        const loader = document.getElementById('loader');

        /**
         * Calls the Gemini API with exponential backoff for retries.
         * @param {string} prompt The user's prompt.
         * @param {number} maxRetries The maximum number of retry attempts.
         * @returns {Promise<string>} The response text from the API.
         */
        const callGeminiWithExponentialBackoff = async (prompt, maxRetries = 5) => {
            const systemPrompt = `ä½ æ˜¯ä¸€ä½å°ˆæ¥­ä¸”å‹å–„çš„æ—…éŠé¡§å•ï¼Œæœå‹™æ–¼ä½æ–¼æ—¥æœ¬åŒ—æµ·é“æœ­å¹Œçš„ã€Œæœ­å¹Œãƒ»å¾¡å±…æ‰€ã€æ—…åº—ã€‚
ä½ çš„ä»»å‹™æ˜¯æ ¹æ“šç”¨æˆ¶çš„éœ€æ±‚ï¼Œä»¥ç¹é«”ä¸­æ–‡æä¾›åŒ—æµ·é“çš„æ—…éŠå»ºè­°ï¼Œç›®çš„æ˜¯å¸å¼•ä»–å€‘å‰ä¾†ä½å®¿ã€‚
è«‹ä¿æŒç†±æƒ…ã€è¦ªåˆ‡çš„èªæ°£ã€‚
ä½ çš„å›è¦†æ‡‰è©²çµæ§‹æ¸…æ™°ï¼Œä¾‹å¦‚ä½¿ç”¨æ¨™é¡Œå’Œé …ç›®ç¬¦è™Ÿï¼Œè®“å…§å®¹æ˜“æ–¼é–±è®€ã€‚
è«‹å‹¿æåŠä½ æ˜¯ AI æˆ–èªè¨€æ¨¡å‹ã€‚ç›´æ¥ä»¥åŒ—æµ·é“æ—…éŠé¡§å•çš„èº«ä»½æä¾›å»ºè­°ã€‚`;
            const userQuery = prompt;
            const apiKey = "AIzaSyCtaOQj1zvzG0V6yo23xZG7pH0HRxwAkIQ"; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            let delay = 1000; // Start with 1 second delay
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        // å¦‚æœ API é‡‘é‘°ç„¡æ•ˆæˆ–æœªå¡«å¯«ï¼ŒGoogle æœƒå›å‚³ 403 éŒ¯èª¤ã€‚
                        if (response.status === 403) {
                             return `ç™¼ç”Ÿæ¬Šé™éŒ¯èª¤ (403)ã€‚è«‹æª¢æŸ¥æ‚¨çš„ API é‡‘é‘°æ˜¯å¦å·²æ­£ç¢ºå¡«å¯«ã€‚`;
                        }
                        if (response.status >= 500) {
                            // Retry on server errors
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        const errorData = await response.json();
                        console.error("API Client Error:", errorData);
                        return `ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚ (${response.status})`;
                    }

                    const result = await response.json();
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        return candidate.content.parts[0].text;
                    } else {
                        console.error("Invalid response structure:", result);
                        return "æŠ±æ­‰ï¼Œç„¡æ³•ç²å–å»ºè­°ï¼Œå›è¦†çš„æ ¼å¼æœ‰èª¤ã€‚";
                    }
                } catch (error) {
                    console.error(`Attempt ${i + 1} failed:`, error);
                    if (i === maxRetries - 1) {
                        return "æŠ±æ­‰ï¼Œç›®å‰ç³»çµ±å¿™ç¢Œä¸­ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
                    }
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2; // Double the delay for the next retry
                }
            }
            return "æŠ±æ­‰ï¼Œç³»çµ±ç™¼ç”Ÿæœªé æœŸçš„éŒ¯èª¤ã€‚";
        };

        generateBtn.addEventListener('click', async () => {
            const prompt = promptInput.value.trim();
            if (!prompt) {
                resultContainer.textContent = 'è«‹å…ˆè¼¸å…¥æ‚¨çš„æ—…éŠéœ€æ±‚å–”ï¼';
                resultContainer.classList.remove('hidden');
                return;
            }

            // Show loader and disable button
            loader.classList.remove('hidden');
            generateBtn.disabled = true;
            generateBtn.classList.add('cursor-not-allowed', 'opacity-70');
            resultContainer.classList.add('hidden');

            try {
                const resultText = await callGeminiWithExponentialBackoff(prompt);
                
                // Basic formatting for better display
                const formattedText = resultText
                    .replace(/\*\*(.*?)\*\*/g, '<strong class="font-semibold text-amber-200">$1</strong>') // Bold for **text**
                    .replace(/\*(.*?)\*/g, '<em>$1</em>'); // Italic for *text*
                
                resultContainer.innerHTML = formattedText;
                resultContainer.classList.remove('hidden');
            } catch (error) {
                console.error('Error fetching Gemini response:', error);
                resultContainer.textContent = 'ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚';
                resultContainer.classList.remove('hidden');
            } finally {
                // Hide loader and re-enable button
                loader.classList.add('hidden');
                generateBtn.disabled = false;
                generateBtn.classList.remove('cursor-not-allowed', 'opacity-70');
            }
        });
    </script>
</body>
</html>

